<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Editar Usuário</title>
    <style>
        .fone-field { margin-bottom: 5px; }
        button.remove-fone { margin-left: 5px; }
    </style>
</head>
<body>
    <h1>Editar Usuário</h1>

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <ul>
          {% for message in messages %}
            <li>{{ message }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    <form method="POST">
        <label>Nome:</label>
        <input type="text" name="nome" value="{{ user.pessoa.nome }}"><br><br>

        <label>Sobrenome:</label>
        <input type="text" name="sobrenome" value="{{ user.pessoa.sobrenome }}"><br><br>

        <label>Email:</label>
        <input type="email" name="email" value="{{ user.email }}"><br><br>

        <label>CPF:</label>
        <input type="text" name="cpf" value="{{ user.pessoa.cpf }}"><br><br>

        <label>Data de nascimento:</label>
        <input type="date" name="data_nasc" value="{{ user.pessoa.data_nasc }}"><br><br>

        <label>Telefones:</label>
        <div id="fones-container">
            {% for fone in fones %}
            <div class="fone-field">
                <input type="text" name="fones" value="{{ fone.fone }}">
                <button type="button" class="remove-fone" onclick="removeFone(this)">Remover</button>
            </div>
            {% endfor %}
        </div>

        <label>Endereços:</label>
        <div id="enderecos-container">
            {% for end in enderecos %}
            <div class="endereco-field">
                <input type="text" name="rua_av" value="{{ end.rua_av }}">
                <button type="button" class="remove-endereco" onclick="removeEndereco(this)">Remover</button>
            </div>
            {% endfor %}
        </div>

        <button type="button" onclick="addFone()">Adicionar telefone</button><br><br>
        <button type="button" onclick="addEndereco()">Adicionar endereço</button><br><br>
        <button type="submit">Salvar</button>
    </form>

    <script>
        function addFone() {
            const container = document.getElementById('fones-container');
            const div = document.createElement('div');
            div.className = 'fone-field';
            div.innerHTML = '<input type="text" name="fones" value=""> ' +
                            '<button type="button" class="remove-fone" onclick="removeFone(this)">Remover</button>';
            container.appendChild(div);
        }

        function removeFone(btn) {
            const div = btn.parentNode;
            div.parentNode.removeChild(div);
        }
    </script>

    <script>
        function addEndereco() {
            const container = document.getElementById('enderecos-container');
            const div = document.createElement('div');
            div.className = 'endereco-field';
            div.innerHTML = '<input type="text" name="rua_av" value=""> ' +
                            '<button type="button" class="remove-endereco" onclick="removeEndereco(this)">Remover</button>';
            container.appendChild(div);
        }

        function removeEndereco(btn) {
            const div = btn.parentNode;
            div.parentNode.removeChild(div);
        }
    </script>
</body>
</html>
